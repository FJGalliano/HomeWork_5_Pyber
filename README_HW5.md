

```python
import os
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
```


```python
# Take in both data files and then code to read them into pandas
city1="raw_data/city_data_a.csv"
ride1="raw_data/ride_data.csv"

city_df = pd.read_csv(city1)
ride_df = pd.read_csv(ride1)
```


```python
# Merge the two datasets so that no data is lost
combined_df = pd.merge(city_df, ride_df, how='outer', on='city')
```


```python
# Total rides generated per the data
number_rides =(len(combined_df["fare"]))
number_rides
```


```python
# Total fares generated per the data (%.2f)
total_fares =(sum(combined_df["fare"]))
round(total_fares)
```


```python
# Average fare paid in each city
avg_city_fare = combined_df.groupby('city').fare.mean()
```


```python
total_city_fare = combined_df.groupby('city').fare.sum()
```


```python
# Total number of drivers in each city
city_drivers = city_df[['city','driver_count']]
#city_drivers
```


```python
# Total rides in each city
rides_in_city = combined_df.groupby('city').fare.count()
```


```python
# Tell matplotlib to create a scatter plot based upon the above data
plt.scatter(rides_in_city, avg_city_fare, total_city_fare, marker="o", facecolors="red", edgecolors="blue", alpha=.6, linewidth=2)
```


```python
# Set the upper and lower limits of our y axis
plt.ylim(10,61)
```


```python
# Set the upper and lower limits of our x axis
plt.xlim(0,40)
```


```python
# Create a title, x label, and y label for our chart
plt.xlabel("Number of Rides")
plt.ylabel("Avg Cost per Rides")
plt.title("Cost of Ride per City")
```


```python
# Save an image of the chart and print to screen
plt.savefig("test.jpg")
plt.show()
```


```python
#Calculate the total fare by city type (Urban, Suburban, Rural)
city_fare_type = combined_df.groupby('type').fare.sum()
```


```python
# Labels for the sections of our pie chart
labels = ["Urban", "Suburban", "Rural"]

# The values of each section of the pie chart
sizes = [40078, 19318, 4255]

# The colors of each section of the pie chart
colors = ["lightgreen", "red", "blue"]
explode = (0.1, 0, 0)

```


```python
#Matplotlib pie chart of total fares by city type
plt.pie(sizes, explode=explode, labels=labels, colors=colors,
        autopct="%1.1f%%", shadow=True, startangle=140)
plt.axis("equal")
```


```python
# Save an image of the chart and print to screen
plt.savefig("pie_type1.jpg")
print("Percentage of Total Fares per City Type")
plt.show()
```


```python
#What are the % of Total Rides by City Type
total_rides_type = combined_df.groupby('type').fare.count()
total_rides_type
```


```python
# Labels for the sections of our pie chart
label = ["Urban", "Suburban", "Rural"]

# The values of each section of the pie chart
rides = [1625, 625, 125]

# The colors of each section of the pie chart
colors1 = ["yellow", "pink", "orange"]
```


```python
#Matplotlib pie chart of total fares by city type
plt.pie(rides, explode=explode, labels=label, colors=colors1,
        autopct="%1.1f%%", shadow=True, startangle=140)
plt.axis("equal")
```


```python
plt.savefig("pie_type2.jpg")
print("Percentage of Rides Generated by City Type")
plt.show()
```


```python
#Calculate the total number of drivers per city type
total_drivertype = city_df.groupby('type').driver_count.sum()
total_drivertype
```


```python
# Labels for the sections of our pie chart
label3 = ["Urban", "Suburban", "Rural"]

# The values of each section of the pie chart
drivers = [2607, 638, 104]

# The colors of each section of the pie chart
colors2 = ["grey", "purple", "green"]
```


```python
#Matplotlib pie chart of total fares by city type
plt.pie(drivers, explode=explode, labels=label3, colors=colors2,
        autopct="%1.1f%%", shadow=True, startangle=140)
plt.axis("equal")
```


```python
plt.savefig('pie_type3.jpg')
print("Percentage of Total Driver per City Type")
plt.show()
```


```python
"""
Observation of the data:

1) The data clearly show the significant concentration of the Pyber rides orginating in the urban markets.
2) The data file named city.csv, contained a duplicate entry (Port James) that made it difficult to graph the data.
   I had a difficult time merging or using the .unique function.  So many hack solution was to modify the csv file.
3) I was surprised with average fare prices between the city types were clustered close together.  68% of all of 
   the fares averaged below $30.00.
"""
```
